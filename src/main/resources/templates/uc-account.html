<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta charset="utf-8">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <title>个人信息</title>
    <meta name="keywords" content="">
    <meta name="description" content="">
    <link href="/css/iconfont/iconfont.css" rel="stylesheet" />
    <link href="/css/common.css" rel="stylesheet" />
    <link href="/css/uc.css" rel="stylesheet" />

    <style>
        .tcnew {
            width: 500px;
            height: 200px;
            text-align: center;
            background: gainsboro;
            position: absolute;
            top: 50%;
            left: 50%;
            margin-left: -250px;
            margin-top: -100px;
            z-index: 300;
            display: none;
        }
        
        .close {
            width: 20px;
            height: 20px;
            position: absolute;
            right: 0px;
            top: 0px;
            /* top: 10px; */
            color: black;
            background-color: red;
            font-size: 16px;
            z-index: 201;
            cursor: pointer;
            border: 1px solid black;
        }
        
        .tcnew h3 {
            font-size: 24px;
            color: black;
            position: relative;
            z-index: 201;
            line-height: 30px;
        }
        
        .bk {
            width: 100%;
            height: 1024px;
            background-color: #000;
            opacity: 0.5;
            position: absolute;
            z-index: 100;
            top: 0;
            left: 0;
            display: none;
        }
        
        .btnnewaldum {
            border: none;
            outline: none;
            background: white;
        }
    </style>
</head>


<body>
    <!--头部-->
    <div class="topper">
        <div class="wrapper">
            <div class="left-bar">
                <div class="back-home divider">
                    <em></em><a href="index.html">商城首页</a>
                </div>
                <div class="item"><a href="shangjia.html">商家中心</a></div>
            </div>
            <div class="right-bar">
                <div class="login-user sub-menu">
                    <a class="menu-hd" href="uc.html">个人中心<em></em></a>
                    <div class="down">
                        <a href="">内容</a>
                        <a href="">内容</a>
                        <a href="">内容</a>
                    </div>
                </div>
                <div class="item"><a href="uc-msg.html">消息（<span class="txt-theme">0</span>）</a></div>
                <div class="logout divider"><a onclick="logout()">退出</a></div>
                <span class=""></span>
                <div class="cart"><em></em><a onclick="goCart()">购物车<span class="txt-theme" id="cartNums">0</span>件</a></div>
                <div class="order"><em></em><a onclick="ucorder()">我的订单</a></div>
                <div class="fav"><em></em><a href="uc-fav.html">我的收藏</a></div>
                <div class="help"><em></em><a href="">帮助中心</a></div>
            </div>
        </div>
    </div>
    <div class="uc-header-bg">
        <div class="uc-header wrapper">
            <a class="logo" href="index.html"><img src="/img/logo2.png" alt="" /></a>
            <div class="back-home"><a href="index.html">返回商城首页</a></div>
            <ul class="uc-nav">
                <li><a href="uc.html">首页</a></li>
                <li class="toggle">
                    <span class="label">账户设置<i class="iconfont"></i></span>
                    <div class="toggle-cont">
                        <a href="uc-account.html">个人信息</a>
                        <a href="uc-safe.html">安全设置</a>
                        <a href="uc-address.html">收货地址</a>
                    </div>
                </li>
                <li><a href="uc-evaluate.html">消息中心</a></li>
            </ul>
            <div class="schbox">
                <form action="">
                    <input class="search-txt" type="text" />
                    <button class="search-btn">搜索</button>
                    <div class="suggest-box">
                        <div class="item" data-title="上衣 短款 短袖">上衣 短款 短袖
                            <div class="tags"><span>雪纺</span><span>蕾丝</span><span>一字领</span></div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="wrapper uc-router">
        <ul>
            <li><a href="uc.html">首页</a></li>
            <li><span class="divider"></span></li>
            <li><span>个人中心</span></li>
        </ul>
    </div>

    <div class="wrapper">
        <div class="uc-main clearfix">
            <div class="uc-aside">
                <div class="uc-menu">
                    <div class="tit">订单中心</div>
                    <ul class="sublist">
                        <li><a href="uc-order.html">我的订单</a></li>
                        <li><a href="uc-fav.html">我的收藏</a></li>
                        <li><a href="uc-footprint.html">浏览历史</a></li>
                    </ul>
                    <div class="tit">客户服务</div>
                    <ul class="sublist">
                        <li><a href="">取消订单记录</a></li>
                        <li><a href="uc-refund.html">退款/退货</a></li>
                    </ul>
                    <div class="tit">账户中心</div>
                    <ul class="sublist">
                        <li><a href="uc-account.html">账户信息</a></li>
                        <li><a href="uc-safe.html">账户安全</a></li>
                        <li><a href="">消费记录</a></li>
                        <li><a href="uc-address.html">收货地址</a></li>
                    </ul>
                    <div class="tit">消息中心</div>
                    <ul class="sublist">
                        <li><a href="uc-evaluate.html">商品评价</a></li>
                        <li><a href="uc-msg.html">我的私信</a></li>
                    </ul>
                </div>
            </div>
            <div class="uc-content">
                <div class="uc-panel">
                    <div class="uc-bigtit">个人信息</div>
                    <div class="uc-panel-bd">
                        <div class="account-info clearfix">
                            <div class="col-headpic">
                                <div class="pic-wrap">
                                    <div class="label">头像</div>
                                    <div class="picbox">
                                        <img style="width: 123px; height: 123px;" src="/img/uc/headpic.jpg" id="usertx" alt="" />
                                    </div>
                                    <div class="tcnew">
                                        <span class="close">X</span>
                                        <h3 class="con">修改头像</h3>
                                        <form id="ff" method="post" enctype="multipart/form-data">
                                            <input type="file" class="tx" name="file"><br>
                                            <input type="button" value="立即修改" onclick="upload1()"><br>
                                        </form>
                                    </div>
                                    <div class="bk"></div>
                                    <!-- <a class="edit" href="">修改头像</a> -->
                                    <input type="button" value="修改头像" class="btnnewaldum">
                                </div>
                            </div>
                            <div class="col-userinfo">
                                <div class="control-group">
                                    <div class="hd">真实姓名：</div>
                                    <div class="bd"><input class="ui-txtin" type="text" name="" value="天使溜溜了" /></div>
                                </div>
                                <div class="control-group">
                                    <div class="hd">昵称：</div>
                                    <div class="bd"><input class="ui-txtin" type="text" name="" value="天使溜溜了" /></div>
                                </div>
                                <div class="control-group">
                                    <div class="hd">生日：</div>
                                    <div class="bd"><input class="ui-txtin" type="text" name="" id="birthday" /></div>
                                </div>
                                <div class="control-group">
                                    <div class="hd">性别：</div>
                                    <div class="bd">
                                        <label class="check"><input type="radio" name="sex" />男</label>
                                        <label class="check ml25"><input type="radio" name="sex" />女</label>
                                    </div>
                                </div>
                                <div class="control-group">
                                    <div class="hd">电话：</div>
                                    <div class="bd"><input class="ui-txtin" type="text" name="" /></div>
                                </div>
                                <div class="control-group">
                                    <div class="hd">所在地：</div>
                                    <div class="bd">
                                        <select name="" class="ui-txtin" style="width: 100px;"></select>
                                    </div>
                                </div>
                                <div class="control-group">
                                    <div class="hd">详细地址：</div>
                                    <div class="bd"><input class="ui-txtin" type="text" name="" /></div>
                                </div>
                                <div class="control-group">
                                    <div class="hd">邮箱：</div>
                                    <div class="bd">
                                        <div class="text-black">12345677899@qq.com <a class="edit-btn" href="">修改</a></div>
                                    </div>
                                </div>
                                <div class="control-submit">
                                    <input class="ui-btn-theme submit" type="submit" value="确认" />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!--脚部-->
    <div class="fatfooter">

    </div>
    <!--脚部-->
</body>
<script src="/js/jquery.js"></script>
<script src="/js/jquery.form.js"></script>
<link rel="stylesheet" href="/js/icheck/style.css" />
<script src="/js/icheck/icheck.min.js"></script>
<script src="/js/laydate/laydate.js"></script>
<script src="/js/layer/layer.js"></script>
<script src="/js/global.js"></script>
<script>
    $(function() {
        $('.check').iCheck({
            radioClass: 'sty2-radio'
        });

        laydate({
            elem: '#birthday',
            format: 'YYYY/MM',
            festival: true
        });
    });

    //展示用户头像
    //获得token
    var token = localStorage.getItem("token");
    let usertx = document.getElementById("usertx");
    queryUserTx();
    // document.getElementById("usertx").src = "http://192.168.1.92:81/00.jpg";
    function queryUserTx() {
        $.ajax({
            headers: {
                tokenstring: token
            },
            url: "http://localhost/onl/user/findUserTx",
            type: "get",
            data: {
                tokenstring: token
            },
            success: function(respText) {
                // alert(respText.utx);
                usertx.src = "http://192.168.1.92:8080/img/userImg/" + respText.utx;
                $("#username").html(respText.username);
                var username1 = $("#username").html();

            }
        });
    }
    //修改头像
    $(".btnnewaldum").click(function() {
        $(".tcnew").fadeIn(); //出现
        $(".bk").fadeIn();
    });
    $(".close").click(function() {
        $(".tcnew").fadeOut(); //消失
        $(".bk").fadeOut();
    });

    function upload1() {
        var option = {
            url: "http://192.168.1.92:8080/img/userImg/upload",
            method: "post",
            contentType: false,
            success: function(resp) {
                // alert(resp.originalName);
                // alert(resp.uniqueName);
                var originalName = resp.originalName;
                var uniqueName = resp.uniqueName;
                $(".tcnew").fadeOut();
                $(".bk").fadeOut();

                $.ajax({
                    headers: {
                        tokenstring: token
                    },
                    url: "http://localhost/onl/user/updateUserTx",
                    type: "post",
                    data: {
                        utx: uniqueName
                    },
                    success: function(respText) {
                        alert(respText.message);
                        queryUserTx();
                    }
                })
            },
        };
        $("#ff").ajaxSubmit(option);
    };

    getCartNums();

    function getCartNums() {
        $.ajax({
            headers: {
                token
            },
            url: base + "/cart/findNumber",
            success: function(res) {
                $("#cartNums").html(res.data.nums);
                console.log("更新购物车数量成功:" + res.data.nums)
            }
        })
    };
</script>

</html>